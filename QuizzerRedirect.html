<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Link Redirector</title>
<script>
document.addEventListener("DOMContentLoaded", function() {
    // Your 10 example links
fetch('QuizzerRedirect.txt')
  .then(response => response.text())
  .then(text => {
    const links = text.split('\n').map(line => line.trim()).filter(Boolean);
    // use links array here


    function getCurrentWeek() {
        let now = new Date();
        let startOfYear = new Date(now.getFullYear(), 0, 1);
        let days = Math.floor((now - startOfYear) / (24 * 60 * 60 * 1000));
        return Math.ceil((days + startOfYear.getDay() + 1) / 7);
    }

    let currentWeek = getCurrentWeek();
    let storedWeek = localStorage.getItem("visitedWeek");

    // Reset if it's a new week
    if (storedWeek !== String(currentWeek)) {
        localStorage.setItem("visitedWeek", String(currentWeek));
        localStorage.setItem("visitedLinks", JSON.stringify([]));
    }
    
    // Load visited links from localStorage or create empty array
    let visited = JSON.parse(localStorage.getItem("visitedLinks") || "[]");

    // Find remaining links
    let remaining = links.filter(link => !visited.includes(link));

    if (remaining.length === 0) {
        //localStorage.removeItem("visitedLinks");
        alert("All links visited! Will restart next week");
        //remaining = [...links];
        return;
    }

    // Pick a random remaining link
    let chosen = remaining[Math.floor(Math.random() * remaining.length)];

    // Save visit
    visited.push(chosen);
    localStorage.setItem("visitedLinks", JSON.stringify(visited));

    // Redirect
    window.location.assign(chosen);

    setTimeout(() => {
        location.reload();
    }, 10000);
})
  .catch(err => console.error('Failed to load links:', err));

});
</script>
</head>
<body>
<p>Redirecting...</p>
</body>
</html>
